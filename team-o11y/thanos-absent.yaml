# Taken from upstream https://github.com/thanos-io/thanos/blob/main/examples/alerts/alerts.md#absent-rules
groups:
  - name: thanos-absent
    rules:

    - alert: ThanosCompactIsDown
      annotations:
        description: ThanosCompact has disappeared. Prometheus target for the component
          cannot be discovered.
        summary: Thanos component has disappeared.
        dashboard: https://grafana.wikimedia.org/d/0cb8830a6e957978796729870f560cda/thanos-overview
        runbook: https://wikitech.wikimedia.org/wiki/Thanos#Alerts
      expr: |
        absent(up{job=~".*thanos-compact.*"} == 1)
      for: 5m
      labels:
        severity: critical
        team: o11y

    - alert: ThanosQueryIsDown
      annotations:
        description: ThanosQuery has disappeared. Prometheus target for the component
          cannot be discovered.
        summary: Thanos component has disappeared.
        dashboard: https://grafana.wikimedia.org/d/0cb8830a6e957978796729870f560cda/thanos-overview
        runbook: https://wikitech.wikimedia.org/wiki/Thanos#Alerts
      expr: |
        absent(up{job=~".*thanos-query.*"} == 1)
      for: 5m
      labels:
        severity: critical
        team: o11y

    - alert: ThanosRuleIsDown
      annotations:
        description: ThanosRule has disappeared. Prometheus target for the component cannot
          be discovered.
        summary: Thanos component has disappeared.
        dashboard: https://grafana.wikimedia.org/d/0cb8830a6e957978796729870f560cda/thanos-overview
        runbook: https://wikitech.wikimedia.org/wiki/Thanos#Alerts
      expr: |
        absent(up{job=~".*thanos-rule.*"} == 1)
      for: 5m
      labels:
        severity: critical
        team: o11y

    - alert: ThanosSidecarIsDown
      annotations:
        description: ThanosSidecar has disappeared. Prometheus target for the component
          cannot be discovered.
        summary: Thanos component has disappeared.
        dashboard: https://grafana.wikimedia.org/d/0cb8830a6e957978796729870f560cda/thanos-overview
        runbook: https://wikitech.wikimedia.org/wiki/Thanos#Alerts
      expr: |
        absent(up{job=~".*thanos-sidecar.*"} == 1)
      for: 5m
      labels:
        severity: critical
        team: o11y

    - alert: ThanosStoreIsDown
      annotations:
        description: ThanosStore has disappeared. Prometheus target for the component
          cannot be discovered.
        summary: Thanos component has disappeared.
        dashboard: https://grafana.wikimedia.org/d/0cb8830a6e957978796729870f560cda/thanos-overview
        runbook: https://wikitech.wikimedia.org/wiki/Thanos#Alerts
      expr: |
        absent(up{job=~".*thanos-store.*"} == 1)
      for: 5m
      labels:
        severity: critical
        team: o11y

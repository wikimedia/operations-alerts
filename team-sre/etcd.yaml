groups:
  - name: etcd-mirror
    rules:
      - alert: EtcdReplicationLag
        expr: 'etcdmirror_lag > 50'
        for: 15m
        annotations:
          summary: 'etcd-mirror is lagging: {{ $value }} #page'
          description: 'The etcd-mirror process on {{ $labels.instance }} has detected lag for {{ $labels.url }}'
          runbook: 'https://wikitech.wikimedia.org/wiki/Etcd'
        labels:
          severity: page
          team: sre
      - alert: EtcdReplicationDown
        expr: 'up{job="etcdmirror"} != 1'
        for: 2m
        annotations:
          summary: 'etcd replication down on {{ $labels.instance }} #page'
          description: 'The etcd-mirror instance on {{ $labels.instance }} is down or unresponsive'
          runbook: 'https://wikitech.wikimedia.org/wiki/Etcd/Main_cluster#Replication'
        labels:
          severity: page
          team: sre
